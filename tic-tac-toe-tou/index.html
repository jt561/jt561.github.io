<!DOCTYPE html>
<html lang="en-GB" dir="ltr">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<title>Tic-Tac-Toe-Tou</title>

		<style>
			* {
				padding: 0;
				margin: 0;
				box-sizing: border-box;
			}

			.board-wrapper {
				display: block;
				width: 100vmin;
				height: 50vmin;
				margin: 0 auto;
			}

			.board {
				width: 50%;
				height: 100%;
				margin: 0 auto;
			}

			.row {
				display: flex;
				height: 33.3%;
				width: 100%;
				display: table;
			}

			.col {
				height: 100%;
				width: 33.3%;
				border: 1px solid black;
				text-align: center;
				display: table-cell;
  			vertical-align: middle;
				font-size: 10vmin;
			}
		</style>

		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
		<script type="text/javascript">
			/* Global variables */

			// current players text, defult is X
			let currentPlayer = "X";

			// current winner
			let winner = "";

			// stores all the possible win combination
			// stores the row and column for cells
			let winCombos = [
				["00","01","02"], // rows
				["10","11","12"],
				["20","21","22"],
				["00","10","20"], // cols
				["01","11","21"],
				["02","12","22"],
				["00","11","22"], // diagonals
				["02","11","20"]
			];

			// 2D array, stores a "virtual" version of the html board
			let boardArr = [["","",""],["","",""],["","",""]];

			/* start of document ready */
			$(document).ready(function() {
				/* start of document ready */

				// insert values into cells
				// checks the current state of cell
				// changes the current player
				$('.col').click(function() {
					// insert text only if cell is empty and there is no winner
					if (cellIsEmpty($(this)) && winner.length == 0)
					{
						// insert text into array "virtual baord"
						// and insert text into html cell
						insertIntoArray($(this))

						// check for winner
						if (checkForWinner() == "X")
						{
							winner = "X";
							return;
						}
						else if (checkForWinner() == "O")
						{
							winner = "0";
							return;
						}
						// check for tie
						if (checkForTie())
						{
							winner = "No one";
							return;
						}

						// switch current player
						changeCurrentPlayer();
					}
				});

				// add event listener reset button
				$('#resetBtn1.Btn').click(function() {
					// calls reset function to reset board
					resetBoard();
				});

				/* end of document ready */
			});
			/* end of document ready */

			/* Global functions */

			// returns true if a given element has no text in it
			function cellIsEmpty(cell)
			{
				return (cell.text() === "");
			}

			// changes the current player
			function changeCurrentPlayer()
			{
				currentPlayer = (currentPlayer === "O") ? "X" : "O";
			}

			// inserts current value into the 2D array "virtual baord"
			// then inserts text onto board
			function insertIntoArray(cell)
			{
				// display the current player in html
				cell.text(currentPlayer);

				// store the value in the array
				// first get the cells row and column number
				// the cells id stores this, eg id='12', meaning row 1, column 2
				let r = parseInt(cell.attr('id').split("")[0]);
				let c = parseInt(cell.attr('id').split("")[1]);
				boardArr[r][c] = currentPlayer;
			}

			// checks for a winner and returns winner
			function checkForWinner()
			{
				// loop through win combinations
				for (let i = 0; i < winCombos.length; i++)
				{
					// for each combination, get the 3 cells that make a win
					// split the string to get the row and column number for each cell
					// map the string elements to int elements
					let cell1 = winCombos[i][0].split("").map(n => +n);
					let cell2 = winCombos[i][1].split("").map(n => +n);
					let cell3 = winCombos[i][2].split("").map(n => +n);
					let boardCombos = boardArr[cell1[0]][cell1[1]] + boardArr[cell2[0]][cell2[1]] + boardArr[cell3[0]][cell3[1]];

					// if x matches any combo, return X, else return O and exit loop/function
					if (boardCombos === "XXX")
					{
						return "X";
					}
					else if (boardCombos === "OOO")
					{
						return "O";
					}
				}
				// if now match is found, return "No one"(not applicable)
				return "No one";
			}

			// checks to see if board is full and there is no winner
			function checkForTie()
			{
				// if there is no winner yet, check if board is full
				if (checkForWinner() == "No one")
				{
					let lettersInBoard = "";
					for (let i = 0; i < boardArr.length; i++)
					{
						for (let j = 0; j < boardArr[i].length; j++)
						{
							lettersInBoard += boardArr[i][j];
						}
					}
					// if there are 9 letters on the board, board is full
					return lettersInBoard.length == 9;
				}
			}

			// resets board
			function resetBoard()
			{
				// clear actual array
				boardArr = [["","",""],["","",""],["","",""]];

				// clear html board
				$('.col').each(function() {
					$(this).text("");
				});
			}
		</script>
	</head>
	<body>
		<div class="board-wrapper">
			<div class="board">
				<div class="row">
					<div id="00" class="col"></div>
					<div id="01" class="col"></div>
					<div id="02" class="col"></div>
				</div>
				<div class="row">
					<div id="10" class="col"></div>
					<div id="11" class="col"></div>
					<div id="12" class="col"></div>
				</div>
				<div class="row">
					<div id="20" class="col"></div>
					<div id="21" class="col"></div>
					<div id="22" class="col"></div>
				</div>
			</div>
		</div>
		<div class="control-center">
			<button id="resetBtn1" class="Btn" type="button" name="reset">Reset</button>
		</div>
	</body>
</html>
